#include <iostream>
#include <NTL/ZZ.h>
#include <vector>

using namespace std;
using namespace NTL;

void calculateCRT(ZZ &a, ZZ &p, const ZZ &b, const ZZ &m)
{
    ZZ A = b;
    ZZ P = m;
    CRT(a, p, A, P);
}

int main()
{
    ZZ b1, b2, b3, b4;
    ZZ m0, m1, m2, m3, m4;
    ZZ a, p;

    m0 = conv<ZZ>("1736384705673475205982857312139496464413221197916006192110407827701317175304929922498646160697311595700710154066317321303450608258249077462058022436205588933718941714759281345441013083955684291120852471403945848612868400140576585986959483671374078306634538926174851459570163266483859223350410326165163211264675861398749697807860366006483109103092924041589541219023231321765284213368710383749453819738744762675706760675364342983053950587212882791918009485212927530967754493582038394905435773232212562691486983756907266632524057600871120477213540278042680787093409282223062610268777598184118795247984220284817483934007031703860983384328104773383441856808734356538912358650024596851260844778111308894036284249144165206324506098120823591129431804908188838572968196351908405525252076259132793207264019448384151842990849035832273074428992158795213282689246665942234551340541855014478868003268208078687386574303979541722902916245153912764630082840483438390775897070352428248856673663602687302435818409772185766380291741294029682020224059014415174949302122562055371403215577439676953327482947243515147683085293899030798896248648132164607690882480364051167206712342824094781270272110677260335674129562904971869401698106031572984511219578309150373");
    m1 = conv<ZZ>("9372139057135503338472463110573082189272852704414301618241075480699247750407839649186477734175990457653828666900427145703487359666995545974273722924766389931081004948659192619240997005649314025244045506085373430472905232200569725147543512073540668023520509363787324830306471295625528128213035409413048347541498976053200713234702990806288492851212324712739724696491949872288939913156935554134933496268709526787560499685614358990416517000177974490569636478818082951394238301108419643182283792480025752647223938913201699930054211198600275590790784581868778878368589732925522803252047365857525166110212602380381618136623332251035683359055190235195726205957018198588909822574622477907616612281434688599728381845424895028239275521501881194695632091949858794645487095638760238921445705796020484698937251486261899936289030393671719188825266063479868419112691815977085866098096465659614287374229341992757640978429586347727752834531756831530777170727941411561449163404890573321518856414328565203575130835517946925866000246491858896623707925048564632772853913437487903123110967408147955919901254878626325466156563484490632793060034447295479232802403854249456807851811159756824549589781372914146887629269190710334039696802156148334049442426851216803");
    m2 = conv<ZZ>("29839315563020332972163992993166488591849867575416727772381886833124397084064826029796601494214746674524870912698876573655290869848005732680795499964361748111249530176741049062214024343417998623724288923408977366713997438462545279432567621220837690182922401389814563156255989047481167218150671107120270944467831563906940215175596333944553923355253155914180644757017604037124876423887601751691037442629123043366475657729133560796483204380118934066745426480862436684331339210081823493017413712232679451005343319630611742609880955895687011164250381872039275493022706184681258621269684542950015965104029283561461569709061809530687043216955394090711128224138011770552299542123967091370726307364508950984445710728535310502124191100254356061601670740891074402479321726960804189723689788819794672477482058386873048794424108056831867282688872165194608793373903355569888926168258448094736006682030175016531416126927462428363499352190143143815174569347121495749230687461379667913699454440022598288026564920603456189864135308911210555750386655586954954731584153001779408480333849442668407783655655945319365518484259387539299163930992059452759676454544729589301299240621831801160747613023672879419499304168054844777102612843790230782927925788117111363");
    m3 = conv<ZZ>("65528033776926383767955708512861799353240878935258698410578407285024527183906398251461305441951447829508277793787169920309937086887205153882719583967091574315070458131146129434219978440078658833973705075390940672636010909555111856595976128030487571585393997110122231642139191479953613297532409735932467180167688693359566913429835971431788051125912709347158876093134822369405371000260329782010965144954622768092289114083863159931140193692391723312430598226231441321908372439352836790259518384978827233040858039816705203973416041761409910638530497732909724254589737640386795724860471638858200650618720267565970119182925356883196721753254045402692342281459007757732487707145735896378533140690774852885468823131498901360100827211148021033660657875716996017895770936618655625811627097366546568994502962119982215182486554308645313703650368579752763816214546605683730322165748580813211578876371735516080550174639881117197375797404771029960718858959595201681106582726367744886769867331775376270773423629843803591372056071513521650226316730105020721514594201050778261661646781522023237592261664128787728524777146503234140699649436547433792522812402623925299564377472732741154282628429597808051919910903656842630829063769422136998805752781782574879");
    m4 = conv<ZZ>("111870581469038836365574324569364646119265710916100400074401074861380423904230472402582093578130460492184748833643141327317212843179919271173747418510595097977939029641050810179018257693051277679660828186127645171048035807401375586997807800385568590508155296850886426031862693445824437022276047701758179584784893314040940244267352922697429558219244823293633901898882136304377226950612596730039458909539054229405120772532125176827917171419596265625367827698108979944990136404864891926347448195257201377030788803650373626574321011274250919788772606662138498241540218581934229014184689018701564592434150591196971091946880004893864200006313313549865534585445892233141021133205319466934116010157652926735701968057002713976983549651062908098879206974889560340149451489293804408805976044004369831963427742740019125659869849588680140673511124307041313127473412087871250638172146506498004040009805274545867453716397796482683844327431762575941237944263244611478484017752841190964103763829373279865940714085049879961908544024961704450243468018978322918704037071463844282175663608310452515387375211179226687926823352583846133100319340083093710085020238977198437705020234335151752444952912927329589589753075352618721196610590363068130204565751335615957");

    b1 = conv<ZZ>("8082567391287102767445298560690044553813775792807410478038890451725418159527612933898111590289458210206134904572564428440438796144149193414007666181343146949507884281121223283345826341035546397041443883787292216675941199733009412353372987068169695117521347198310595186844986553779696279147092719354660759669571560314173594443693585519678106823053390579121185898680910401289227595448355811860140584804366268534973185372861201432978567556137178175590764468322324315183779407563107382094449041709367078066124336036976608982719394255464029077024947698828293508137338545322024862559623951576529056814413670013595305728876603169211751359977209616128292872796963075238018821256362765567374428871476609477800315357949192650431770946481506994911643377857406489820277914573760431700507618395686618333885212201871456200355054876247565197059273530149300370068482871374077190275008507257325695851961830715362047116915673184781468378135756254165777251503458101732464397139084448064150891469302412591489051449612916125831515893199856351088126702277667470030723154612240634775169827991515553834202038319597590927832810776639815346717186079476356061841723238370210440447517867514774538423825875191314420416423542487605607725940697355246318028507990475136");
    b2 = conv<ZZ>("27704363591155632687776089996507163551167875524875819565000129969837358615291166564888779078750004702514384874014254543879428550886581826871711772905610370956761324359986591314206278017657268618008562195063121958686143870789356786643258958549147613109478692303416061097842588549411983310556741870629404941722660256077299490906910734454547822852919704137106281001287974559329743534694827006715976366507481062700098445404591266787477955542303534708877090398811347542708134135057953674666878308576730141495906244912293599664259593641570819417934688419779183615166788460059747509684804861410882916764279655130208294889187829515677433015821861198936695175323099421323630973741919169531658633473734198287123413342144276884518489799465703008317995799854376684155691320884969009741604605369497542702318310768547739114867189254783374040596250432114803713873118076906845266795619214794162396302530962673031526772226867088242666063223194277518604297719819360127356416376218084187073767497744896310691894264653750540659226158573307205779293434589308788710812623754266113467286364868468588734947189904798548752478721671203265198876097796703951086284081366006316467616091305446655161136044633176552456467769534879179853500288572358379831605930043719052");
    b3 = conv<ZZ>("38800917585218274428265386530241442532080301009206690260928477387397026892795292045486316353395177890575038417399812243072688293271854952633827112361344279391706615001968180846641566991307960367894822529224374239534146571698002541766084401760434077701263644302510701882922132960472024850648667901368050284728873637741722189707767126437254136028067626114558589353625284731095362951953371726056486566808906960413178504434808941182418030264320381220704716828386901458189291749704895658404341665159378472152856443931631470922943742561205001074740350361449185723483997745358786621381545101607596494293029031756777198426990282611125039996872524060731368291580294993333991733802915699667805439227911139126679231386736999507392827539072711044212608782148269705461621110135900274483028628479526578587526191953602020230786917210994161742850676195321182816779423533927820099179165660780011725614336604479410246328905943792115153937920367751991867695587371490693314413191407772187593063249324189362265259218426316045098023997587093506989530601411956707686274911241631415623737236189936897289637149817364934807917305584654593863916278049040142973000925255875769298863930702486080480349576056875782306037079282700873142948901489587590920222867033192789");
    b4 = conv<ZZ>("56776289173672257894254392261225342584267092844086020079893348879912503731377343050750475599048674513942828744767425915647081943780428915516240071216575697045941060911646881443451017800322967783155476465215082552909778173992816546737459473011706522217874297007699029991261652904271455267370112825736023455612187211068323228227360684236858477310107786160366213296291903548955436518438451771091627879105935341117874294890216562251588042064780503971170967952437392150164913550714411984748807570958558206844054487165569028843193427648196904351383685807036462111357823589015334390089778700526256346322930699898466734475500186630591470558654002269042095054516212593035559181137349132760538086637413234696107291649493561206967337838896248860283988789319086423496035484919186562410326128869750945570152528419870382880234434505445703717437788757701389097933391740253253951322036936366358787471158706592305888397493816900930026986705707786051414345453381838388118268436871601277080421283042287091820673198505253981729993632168523073309941319595896203998236365998507804739063189191357845318705139455201599232940894053873821242783756286653901206730598947599150887200470806985540812865461654366468254570118550054042125414436063164775400997588298828601");

    a = b1;
    p = m1;

    // 1 ітерація
    calculateCRT(a, p, b2, m2);
    ZZ x1 = a % (m1 * m2 * m3 * m4);

    // 2 ітерація
    calculateCRT(a, p, b3, m3);
    ZZ x2 = a % (m1 * m2 * m3 * m4);

    // 3 ітерація
    calculateCRT(a, p, b4, m4);

    ZZ x3 = a % (m1 * m2 * m3 * m4);

    ZZ s1 = x1 % m0;
    ZZ s2 = x2 % m0;
    ZZ s3 = x3 % m0;

    cout << "Відновлений секрет: " << s1 << endl;
    cout << "Відновлений секрет: " << s2 << endl;
    cout << "Відновлений секрет: " << s3 << endl;

    return 0;
}
