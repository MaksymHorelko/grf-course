#include <iostream>
#include <NTL/ZZ.h>

using namespace std;
using namespace NTL;

int main()
{
    ZZ p, g, x;
    ZZ a, b;
    ZZ M;

    p = conv<ZZ>("720260107635977384669674295427926438006560183586151949469675655505979595786286545176919293564411266131000186156645824261633559912200452869712953012060048146292363331676515225185785804771072704428306020549026668123419579192953326792753628457980932844086521051361585155707546789173899809333208722891868537176998259316637014599384613667878137522028123510073514788320638172758428824196059827531780115570580411550292289102442051435318160920672541221724179862807676079229593355896126823522415972230999836315453037851723494722397747030336887636453798208636047208001626917054580058621137920670394737770237793963045549458017926276785533429776906875872463664411842838601851059531563369587468397408144667845190362798916304697767949007445722069881139710961827711606074089761924556175638870661018801536941740059937402509673707178005048220303541060510769681939606730117311038077245482214580970114460166422590416835818830203805281755517708994370264873175048647036866637582189620446857914209007971297863507185057388439014104839321143791256105136506844065441654918860018221766113674472773414003503672090355990161207465298965416698871157263672455792565483142370177216037504184242654496694425827366896571015558253701025516625738803451008838413584981731634242102142325804820604245484543858105331129071165041597884658496362439526337840266893768958054119251388737986016843905977309794654124619243142786741555456989501848498348847220507680287553396354704989060567714193595901823994879507752500002442761959249558268764217804465483302538601488579654327248706993308451310332077572785537139119395391523543617246805704051327122281537878986293164532840148211297778446309424400590992184371384076581843035677646460377557286786330495619028487987641209654381021871999704904652207524340680885848131066734383399956450803333298262009562680654137764856087984815497320667130030416904827637177760183143546508387852447829957830388310077648358229705048818254071506457770800757541891772912932841863921714699673928718847868700551282689");

    g = conv<ZZ>("556");
    x = conv<ZZ>("634452521090046865557901936415");

    a = to_ZZ("712656484538890176395662749459719094729139898415077745435332594061030744747174553547445230671677358520496057819439926677645790496285440977432070887771237785600632403185983147986863679292703126893563647340427595188978248308011474144595845326219113828193350983277450763615893859614230775296207545370894065520179249064694785615599629380448747267507830959633278204458585382337818126285571029382895631311248733103416570193203630562603014726219423156231676426688169739780553819812901379979890883482178834470916962132921542586406562015432729438051673689063411063751367983724864500067847812937237178814293328646534189351036052078421225234299245896266378169363637422835608620672153418948930562739027110760481765782465276590747742916505723321534086427646412484831330149894939503191914396394523985844010370382440989162301644786841981048789745514295546110295430487487504980380550244390527528485089813782262491810347986145627432496669296785814279807165196046462272099438711307427825692700883253212185711050689978726280084198585730840203582636575319000759103666882842242506274362568617685966281734939435805636949101098593329335255592559978432663970739416135615601090978863941016160583307652819847697164787018180840025912437398127696628236958894321985755045635390689472123716513815794501315071514568894286013596618693750013796412116910490207555786839703180736741265497563846086355840470955303348583625832810591545008136390049654166225004923461649007176588611738345756078778091681793346000581346144123936033790866163465087642936455355543038212615982462857162953392587302917700162686029884627567158126531774874075752951568081684367401094202544631571427361643854733229577435302726202868493214321281591313392629249033931828748680818841058646137090795439983232081267895325852863105785161641009365667684879935299312634323043701603318719236509740694518667009836591989268076418066700015871462331893592968072656971069003385089450279238777467535096923315631964184267192198899701784793894295130527976528130851564596340");
    b = to_ZZ("22223547061490137705624828556632398180944633064081521518837519414027120966995830326129486480613767479046372092560601488453919322743967093712956959362409228207384507354972393410373855607469248459215888062612943242403481068049673777423092563741944548162082929950268502739610980556942310157618745394506930406486416502469103449072350532543457909025558837408333255854248829288314751327148826171569109927777516447396452909150257146804541765903715951473736405290667645500863030072088527419813188401950817766284794613582087897423733375156665288166194750495347098154929684491590026442010558799537356429178688783180307419169734012988510986359398964173763272367904227856848803959641074286364240083398754463868738989359683858600529742677319859202946833614836520752592598955320147090322665273237544375125239656659040193994990052075299973814277819288203556732895264449529864444647019854924449261822446697958298236398325473750941299939252263277330357652736992387281372581244381284208602536395633419203950842611323115200896923509838216718346886994991833937486835643083188607943284770580557019360401900838228236207628640217689590820396131572400212411998277987024424100022264981664186903330129429159290957158547503898854633963323886658982697859884408741959503522783790046564041748819288739513399241665257627295214543700914855455526224067632091196334174241684490796883569121838318171635438417082527875043256180805826706640513127745951850061253636144116071681352800653184038786939069646067894155881557368371468987418063201409972128527789491444684867411978475041401501051379450763023674729673133072630421610513939869979210620371865272654674572598412424925843264042637472825115618588347392163588573349357930026244640057244013713521337014264222519102257995725426119823918228107342780373958669080605903587099700143599504763045623654856936737592691739759129106468647377683835568238550605080896471223318359397688880060754014664406865142503245041521439216276168846239912624121732014449050282674945357843657390715525462");

    M = (b * PowerMod(a, p - 1 - x, p)) % p;

    cout << "Розшифроване повідомлення M: " << M << endl;

    return 0;
}
