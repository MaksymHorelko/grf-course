#include <iostream>
#include <NTL/ZZ.h>

using namespace std;
using namespace NTL;

/*

a = g^k mod(p)

Оскільки для M1 та M2 використовувалися однакові значення p, g та через помилку k,
то значення a буде однаковим в обох повідомленнях: a1 = a2.

M(a,b) = b * a^(p-1-x) mod(p), тож

M1(a1, b1) = b1 * a1^(p - 1 - x) mod(p)
M2(a2,b2) = b2 * a2^(p - 1 -x) mod(p)

Поділимо вирази між собою:

M1(a1, b1)        b1 * a1^(p - 1 - x) mod(p)
----------  ==   ---------------------------
M2(a2, b2)        b2 * a2^(p - 1 - x) mod(p)


M1(a1, b1)        b1
----------  ==   ----  mod(p)
M2(a2, b2)        b2


                  b1
M1(a1, b1)  ==   ---- * M2(a2, b2) mod(p)
                  b2

*/

int main()
{
    ZZ p, b1, b2, M2;

    p = conv<ZZ>("720260107635977384669674295427926438006560183586151949469675655505979595786286545176919293564411266131000186156645824261633559912200452869712953012060048146292363331676515225185785804771072704428306020549026668123419579192953326792753628457980932844086521051361585155707546789173899809333208722891868537176998259316637014599384613667878137522028123510073514788320638172758428824196059827531780115570580411550292289102442051435318160920672541221724179862807676079229593355896126823522415972230999836315453037851723494722397747030336887636453798208636047208001626917054580058621137920670394737770237793963045549458017926276785533429776906875872463664411842838601851059531563369587468397408144667845190362798916304697767949007445722069881139710961827711606074089761924556175638870661018801536941740059937402509673707178005048220303541060510769681939606730117311038077245482214580970114460166422590416835818830203805281755517708994370264873175048647036866637582189620446857914209007971297863507185057388439014104839321143791256105136506844065441654918860018221766113674472773414003503672090355990161207465298965416698871157263672455792565483142370177216037504184242654496694425827366896571015558253701025516625738803451008838413584981731634242102142325804820604245484543858105331129071165041597884658496362439526337840266893768958054119251388737986016843905977309794654124619243142786741555456989501848498348847220507680287553396354704989060567714193595901823994879507752500002442761959249558268764217804465483302538601488579654327248706993308451310332077572785537139119395391523543617246805704051327122281537878986293164532840148211297778446309424400590992184371384076581843035677646460377557286786330495619028487987641209654381021871999704904652207524340680885848131066734383399956450803333298262009562680654137764856087984815497320667130030416904827637177760183143546508387852447829957830388310077648358229705048818254071506457770800757541891772912932841863921714699673928718847868700551282689");

    M2 = conv<ZZ>("100");

    b1 = conv<ZZ>("489884876438417265746115413695365001104464678602484358633275171194297126899661285950137215595163534037458956049354745023256454410033248528406187762974147724570913740889414982319388579133217041344282408917747143439514988170299832761144094590003134533609696089759298860931086988093646738532602244214710037934075522465262685234908898477875698021493024802739565577123984491775021154125147258283275666576814917865879443123159136781468036432527639980980809774179350851759707482425849414546077038697878813227809675739959016147022094492953595298482538692533878355238478783990142409517931978494673958970623456509986892790648304792987613710460355922737244951104084213811062792220935915561613093633845288560032706041713315878115791194632771051908992410183241967464894730230707901511286571960175411262982333801267530422411382061889435066276714805865447428098036958038628201034117686995341448924693959348818161424927099735692460726856968167734863885647421277526180143375889954579333703424884058698574519604953440683788173025495650334645371274858688467870246111223907111193823363274154262967521531872552062445509161448159069777216335333450319956900452055451050258365866845835971968064785917329566782232146655306968648513328563255940896912890045452915437401812816207713532342950991961161944206226652379408101351181870398750401327898304310544665364750399108395885199014896447309757446260621353397537394442464881729406306743777734621921680236637170651574233733611912298777238774955541219987455087214326836418206722527254241599493069172820299280678764930845626478822394661573051218577200447671410340518871256256243751427772523066299972792288415484695241946565781780660960458861818809084729219665782276590699840956415771449402345415365359611227883465324345578180560940880016859367571073077938280609662824462655182431744815566016364460280478988044471934679605111741224841872624584373382949002416956852653798087688281714551426249802784557006785635446746825476031280296755119962907178068409993482972179611250074036");

    b2 = conv<ZZ>("117499421302636936732480458004994188859531926978006191021036372275965665936629715715552807806591456026183773725130706653738421623029499508642948229537582839484625334908521379275174261304598868709139760990478938388656776271168155375707068410517993604193371926575743374562578188052968385454564083455112142718980115305537500031859099782979594284752167552393012585059124372113687454260167615843432193050833059506836995726250418446587362208910149830606009753000284475346150667578919477631998031042061015255181203936531056316193673745715312430025395604320513667644449195304536525157490165331215520412947882927897303772602180687607275516477236409662631019510812624783268701452207145679498355943732800982775475520109818747799190932412889073114779875513603729250714960003020274064544169772177040707831302494255915891607093051706069015470587365473748911747046507405127276147452154989051680036181279150623325526175534178216260306555284259712546048883620103562388592304737312971118808849180473600411690972929447344369895312211976130701157336520934787040568585379890641689868219582316303107993658860514519325840045656763724354480389721346871217763895317352528951566960875998444913156974559100725767303504390113004263561461865230521824614668134599431195073431210545927967223997038309275046280997839306746961248164258769265535040289690797836806320058925847327710227179741959430609440964989851220606681662715644196246167948074988443308715348910033416176697364687689626651148991603897911318549465738886285081064139928739174597610485343028372793427719263488862650721505174293569372990700721132985585723363509026903463921358143637858787934897908054290977085211662055294597056876179719559553727333780764456153421350797997865233659948831320822699600230126223151240391749347458722980889420282968598866090986994787376827127029537154096158511941083637707033158373333266841845808093841414331028636098430029436004271288067101141827933384332405455975537184975608754918428599730272913379185694632849105856947896806643914");

    ZZ M1 = ((b1 / b2) * M2) % p;
    cout << "Отримане M1: " << M1 << endl;

    return 0;
}
